var yr={};(function(){yr.log=function(){};var modules={};var RE_AMP=/&/g;var RE_LT=/</g;var RE_GT=/>/g;var RE_QUOTE=/"/g;var RE_E_AMP=/&amp;/g;var RE_E_LT=/&lt;/g;var RE_E_GT=/&gt;/g;yr.text2xml=function(s){if(s==null){return""}return(""+s).replace(RE_AMP,"&amp;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.xml2text=function(s){if(s==null){return""}return(""+s).replace(RE_E_LT,"<").replace(RE_E_GT,">").replace(RE_E_AMP,"&")};yr.text2attr=function(s){if(s==null){return""}return(""+s).replace(RE_AMP,"&amp;").replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.xml2attr=function(s){if(s==null){return""}return(""+s).replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.register=function(id,module){if(modules[id]){throw Error('Module "'+id+'" already exists')}var ids=module.imports||[];var imports=[module];for(var i=0,l=ids.length;i<l;i++){var module_=modules[ids[i]];if(!module_){throw Error('Module "'+ids[i]+"\" doesn't exist")}else{imports=imports.concat(module_.imports)}}module.imports=imports;modules[id]=module};yr.run=function(id,data,mode){mode=mode||"";var module=modules[id];if(!module){throw'Module "'+id+'" is undefined'}var doc=new Doc(data);var r=module.a(module,0,[doc.root],mode,{a:{}});return r};yr.join=function join(left,right){return left.concat(right)};yr.nodeValue=function nodeValue(node){var data=node.data;return typeof data==="object"?"":data};yr.nodeName=function nodeName(nodeset){var node=nodeset[0];return node?node.name:""};yr.simpleScalar=function simpleScalar(name,context){var data=context.data;if(!data){return""}if(name==="*"){for(var key in data){return yr.simpleScalar(key,context)}return""}var r=data[name];if(typeof r==="object"){return""}return r===undefined?"":r};yr.simpleBoolean=function simpleBoolean(name,context){var data=context.data;if(!data){return false}if(name==="*"){for(var key in data){var r=yr.simpleBoolean(key,context);if(r){return true}}return false}var r=data[name];if(!r){return false}if(Array.isArray(r)){return r.length}return true};yr.nodeset2scalar=function nodeset2scalar(nodeset){if(!nodeset.length){return""}var data=nodeset[0].data;return typeof data=="object"?"":data};yr.nodeset2boolean=function nodeset2boolean(nodeset){if(!(nodeset&&nodeset.length>0)){return false}return!!nodeset[0].data};yr.nodeset2xml=function nodeset2xml(nodeset){return yr.scalar2xml(yr.nodeset2scalar(nodeset))};yr.nodeset2attrvalue=function nodeset2attrvalue(nodeset){return yr.scalar2attrvalue(yr.nodeset2scalar(nodeset))};yr.scalar2xml=yr.text2xml;yr.xml2scalar=yr.xml2text;yr.xml2attrvalue=yr.xml2attr;yr.scalar2attrvalue=yr.text2attr;yr.object2nodeset=function object2nodeset(object){return[new Doc(object).root]};yr.array2nodeset=function array2nodeset(array){var object={item:array};return[new Doc(object).root]};yr.cmpSN=function cmpSN(left,right){for(var i=0,l=right.length;i<l;i++){if(left==yr.nodeValue(right[i])){return true}}return false};yr.cmpNN=function cmpNN(left,right){var m=right.length;if(m===0){return false}if(m===1){return yr.cmpSN(yr.nodeValue(right[0]),left)}var values=[];var rv=yr.nodeValue(right[0]);for(var i=0,l=left.length;i<l;i++){var lv=yr.nodeValue(left[i]);if(lv==rv){return true}values[i]=lv}for(var j=1;j<m;j++){rv=yr.nodeValue(right[j]);for(var i=0,l=left.length;i<l;i++){if(values[i]==rv){return true}}}return false};yr.shortTags={br:true,col:true,embed:true,hr:true,img:true,input:true,link:true,meta:true,param:true,wbr:true};yr.closeAttrs=function closeAttrs(a){var name=a.s;if(name){var r="";var attrs=a.a;for(var attr in attrs){r+=" "+attr+'="'+attrs[attr].quote()+'"'}r+=yr.shortTags[name]?"/>":">";a.s=null;return r}return""};yr.copyAttrs=function copyAttrs(to,from){for(var key in from){to[key]=from[key]}};yr.scalarAttr=function(s){this.s=s==null?"":""+s};yr.scalarAttr.prototype.quote=function(){return yr.text2attr(this.s)};function quoteAmp(s){return s.replace(/&/g,"&amp;")}yr.scalarAttr.prototype.addxml=function(xml){return new yr.xmlAttr(quoteAmp(this.s)+xml)};yr.scalarAttr.prototype.addscalar=function(xml){return new yr.scalarAttr(this.s+xml)};yr.xmlAttr=function(s){this.s=s==null?"":""+s};yr.xmlAttr.prototype.quote=function(){return yr.xml2attr(this.s)};yr.xmlAttr.prototype.addscalar=function(scalar){return new yr.xmlAttr(this.s+quoteAmp(scalar))};yr.slice=function(s,from,to){s=""+s;return to?s.slice(from,to):s.slice(from)};yr.exists=function(nodeset){return nodeset.length>0};yr.grep=function(nodeset,predicate){var r=[];for(var index=0,count=nodeset.length;index<count;index++){var node=nodeset[index];if(predicate(node,index,count)){r.push(node)}}return r};yr.byIndex=function(nodeset,i){return nodeset.slice(i,i+1)};yr.sort=function(nodes,by,desc){var values=[];for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];var value=by(node,i,l);values.push({node:node,value:value})}var greater=desc?-1:+1;var less=desc?+1:-1;var sorted=values.sort(function(a,b){var va=a.value;var vb=b.value;if(va<vb){return less}if(va>vb){return greater}return 0});var r=[];for(var i=0,l=sorted.length;i<l;i++){r.push(sorted[i].node)}return r};yr.nodeset2data=function(nodes){var l=nodes.length;if(l===0){return""}if(l===1){return nodes[0].data}var data=[];for(var i=0;i<l;i++){data.push(nodes[i].data)}return data};yr.externals={};var Module=function(){};Module.prototype.a=function applyValue(M,start,nodeset,mode,a0){var r="";var args;if(arguments.length>5){args=Array.prototype.slice.call(arguments,5)}var imports=M.imports;for(var i0=0,l0=nodeset.length;i0<l0;i0++){var c0=nodeset[i0];var found=false;var module;var i2=start;var l2=imports.length;var template;while(!found&&i2<l2){module=imports[i2++];var names=module.matcher[mode];if(names){var templates=names[c0.name]||names["*"];if(templates){var i3=0;var l3=templates.length;while(!found&&i3<l3){var tid=templates[i3++];template=module[tid];var selector=template.j;if(selector){if(module.matched(selector,template.a,c0,i0,l0)){found=tid}}else{var selectors=template.s;var abs=template.a;for(var i4=0,l4=selectors.length;i4<l4;i4++){if(module.matched(selectors[i4],abs[i4],c0,i0,l0)){found=tid;break}}}}}}}if(found){if(args){r+=template.apply(M,[M,c0,i0,l0,a0].concat(args))}else{r+=template(M,c0,i0,l0,a0)}}}return r};Module.prototype.matched=function matched(jpath,abs,c0,i0,l0){if(jpath===1){return!c0.parent}var l=jpath.length;var i=l-2;while(i>=0){if(!c0){return false}var step=jpath[i];switch(step){case 0:var name=jpath[i+1];if(name!=="*"&&name!==c0.name){return false}c0=c0.parent;break;case 2:case 4:var predicate=jpath[i+1];if(!predicate(this,c0,i0,l0)){return false}break}i-=2}if(abs&&c0.parent){return false}return true};Module.prototype.s=function selectN(jpath,node){return this.n(jpath,[node])};Module.prototype.n=function selectNs(jpath,nodeset){var current=nodeset;var m=current.length;var result;for(var i=0,n=jpath.length;i<n;i+=2){result=[];var type=jpath[i];var step=jpath[i+1];switch(type){case 0:for(var j=0;j<m;j++){yr.selectNametest(step,current[j],result)}break;case 1:for(var j=0;j<m;j++){var k=0;var node=current[j];while(k<step&&node){node=node.parent;k++}if(node){result.push(node)}}break;case 2:for(var j=0;j<m;j++){var node=current[j];if(step(this,node,j,m)){result.push(node)}}break;case 3:var node=current[step];result=node?[node]:[];break;case 4:if(m>0){var node=current[0];if(step(this,node.doc.root,0,1)){result=result.concat(current)}}}current=result;m=current.length;if(!m){return[]}}return result};yr.selectNametest=function selectNametest(step,context,result){var data=context.data;if(!data||typeof data!=="object"){return result}if(step==="*"){if(Array.isArray(data)){for(var i=0,l=data.length;i<l;i++){yr.selectNametest(i,context,result)}}else{for(step in data){yr.selectNametest(step,context,result)}}return result}data=data[step];if(data===undefined){return result}var doc=context.doc;if(Array.isArray(data)){for(var i=0,l=data.length;i<l;i++){result.push({data:data[i],parent:context,name:step,doc:doc})}}else{result.push({data:data,parent:context,name:step,doc:doc})}return result};yr.document=function(nodeset){var doc;if(!nodeset.length){doc=new Doc({})}else{doc=new Doc(nodeset[0].data)}return[doc.root]};yr.subnode=function(name,data,context){var doc=context.doc;if(Array.isArray(data)){var nodeset=[];for(var i=0,l=data.length;i<l;i++){nodeset.push({data:data[i],name:name,parent:context,doc:doc})}return nodeset}return[{data:data,name:name,parent:context,doc:doc}]};Module.prototype.v=function vars(id,c0){var vars=c0.doc._vars;var value=vars[id];if(value===undefined){var var_=this.findSymbol(id);value=typeof var_==="function"?var_(this,c0,0,1):var_;vars[id]=value}return value};Module.prototype.f=function funcs(id,c0,i0,l0,v0){var func=this.findSymbol(id);if(arguments.length>5){var args=Array.prototype.slice.call(arguments);args[0]=this;return func.apply(this,args)}if(v0!==undefined){return func(this,c0,i0,l0,v0)}return func(this,c0,i0,l0)};Module.prototype.k=function keys(id,use,c0,multiple){var keys=c0.doc._keys;var key=this.findSymbol(id);var cache=keys[id];if(!cache){cache=this._initKey(key,id,use,c0)}var values=cache.values;var nodes=cache.nodes;var that=this;if(multiple){var r;if(cache.xml){r="";for(var i=0,l=use.length;i<l;i++){var c0=use[i];r+=getValue(yr.nodeValue(c0))}}else{r=[];for(var i=0,l=use.length;i<l;i++){var c0=use[i];r=r.concat(getValue(yr.nodeValue(c0)))}}return r}else{var value=values[use];if(value===undefined){value=getValue(use)}return value}function getValue(use){var nodes_=nodes[use];var r;if(cache.xml){r="";if(nodes_){for(var i=0,l=nodes_.length;i<l;i++){var node=nodes_[i];r+=key.b(that,node.c,node.i,node.l,{})}}}else{r=[];if(nodes_){for(var i=0,l=nodes_.length;i<l;i++){var node=nodes_[i];r=r.concat(key.b(that,node.c,node.i,node.l))}}}values[use]=r;return r}};Module.prototype._initKey=function(key,id,use,c0){var keys=c0.doc._keys;var cache=keys[id]={};cache.xml=key.bt==="xml";var matched=key.n(this,c0);var nodes=cache.nodes={};if(key.ut==="nodeset"){for(var i0=0,l0=matched.length;i0<l0;i0++){var c1=matched[i0];var use_=key.u(this,c1,i0,l0);for(var j=0,m=use_.length;j<m;j++){store(yr.nodeValue(use_[j]),{c:c1,i:i0,l:l0})}}}else{for(var i0=0,l0=matched.length;i0<l0;i0++){var c1=matched[i0];var use_=key.u(this,c1,i0,l0);store(use_,{c:c1,i:i0,l:l0})}}cache.values={};return cache;function store(key,info){var items=nodes[key];if(!items){items=nodes[key]=[]}items.push(info)}};Module.prototype.findSymbol=function(id){var imports=this.imports;for(var i=0,l=imports.length;i<l;i++){var module=imports[i];var symbol=module[id];if(symbol!==undefined){return symbol}}};function Doc(data){if(Array.isArray(data)){data={item:data}}this.root={data:data,parent:null,name:"",doc:this};this._vars={};this._keys={}}yr.Module=Module})();if(typeof module!=="undefined"){module.exports=yr}